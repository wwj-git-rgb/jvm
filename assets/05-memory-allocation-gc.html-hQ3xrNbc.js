import{_ as a,c as o,a as l,o as n}from"./app-BbxH2Yoy.js";const t={};function s(c,e){return n(),o("div",null,e[0]||(e[0]=[l('<h1 id="å†…å­˜åˆ†é…ä¸å›æ”¶ç­–ç•¥" tabindex="-1"><a class="header-anchor" href="#å†…å­˜åˆ†é…ä¸å›æ”¶ç­–ç•¥"><span>å†…å­˜åˆ†é…ä¸å›æ”¶ç­–ç•¥</span></a></h1><p>å¯¹è±¡çš„å†…å­˜åˆ†é…ï¼Œå°±æ˜¯åœ¨å †ä¸Šåˆ†é…ï¼ˆä¹Ÿå¯èƒ½ç»è¿‡ JIT ç¼–è¯‘åè¢«æ‹†æ•£ä¸ºæ ‡é‡ç±»å‹å¹¶é—´æ¥åœ¨æ ˆä¸Šåˆ†é…ï¼‰ï¼Œå¯¹è±¡ä¸»è¦åˆ†é…åœ¨æ–°ç”Ÿä»£çš„ Eden åŒºä¸Šï¼Œå°‘æ•°æƒ…å†µä¸‹å¯èƒ½ç›´æ¥åˆ†é…åœ¨è€å¹´ä»£ï¼Œ<strong>åˆ†é…è§„åˆ™ä¸å›ºå®š</strong>ï¼Œå–å†³äºå½“å‰ä½¿ç”¨çš„åƒåœ¾æ”¶é›†å™¨ç»„åˆä»¥åŠç›¸å…³çš„å‚æ•°é…ç½®ã€‚</p><p>ä»¥ä¸‹åˆ—ä¸¾å‡ æ¡æœ€æ™®éçš„å†…å­˜åˆ†é…è§„åˆ™ï¼Œä¾›å¤§å®¶å­¦ä¹ ã€‚</p><h2 id="å¯¹è±¡ä¼˜å…ˆåœ¨-eden-åˆ†é…" tabindex="-1"><a class="header-anchor" href="#å¯¹è±¡ä¼˜å…ˆåœ¨-eden-åˆ†é…"><span>å¯¹è±¡ä¼˜å…ˆåœ¨ Eden åˆ†é…</span></a></h2><p>å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œå¯¹è±¡åœ¨æ–°ç”Ÿä»£ Eden åŒºä¸­åˆ†é…ã€‚å½“ Eden åŒºæ²¡æœ‰è¶³å¤Ÿç©ºé—´è¿›è¡Œåˆ†é…æ—¶ï¼Œè™šæ‹Ÿæœºå°†å‘èµ·ä¸€æ¬¡ Minor GCã€‚</p><p>ğŸ‘‡<strong>Minor GC</strong> vs <strong>Major GC</strong>/<strong>Full GC</strong>ï¼š</p><ul><li>Minor GCï¼šå›æ”¶æ–°ç”Ÿä»£ï¼ˆåŒ…æ‹¬ Eden å’Œ Survivor åŒºåŸŸï¼‰ï¼Œå› ä¸º Java å¯¹è±¡å¤§å¤šéƒ½å…·å¤‡æœç”Ÿå¤•ç­çš„ç‰¹æ€§ï¼Œæ‰€ä»¥ Minor GC éå¸¸é¢‘ç¹ï¼Œä¸€èˆ¬å›æ”¶é€Ÿåº¦ä¹Ÿæ¯”è¾ƒå¿«ã€‚</li><li>Major GC / Full GCï¼šå›æ”¶è€å¹´ä»£ï¼Œå‡ºç°äº† Major GCï¼Œç»å¸¸ä¼šä¼´éšè‡³å°‘ä¸€æ¬¡çš„ Minor GCï¼Œä½†è¿™å¹¶éç»å¯¹ã€‚Major GC çš„é€Ÿåº¦ä¸€èˆ¬ä¼šæ¯” Minor GC æ…¢ 10 å€ ä»¥ä¸Šã€‚</li></ul><blockquote><p>åœ¨ JVM è§„èŒƒä¸­ï¼ŒMajor GC å’Œ Full GC éƒ½æ²¡æœ‰ä¸€ä¸ªæ­£å¼çš„å®šä¹‰ï¼Œæ‰€ä»¥æœ‰äººä¹Ÿç®€å•åœ°è®¤ä¸º Major GC æ¸…ç†è€å¹´ä»£ï¼Œè€Œ Full GC æ¸…ç†æ•´ä¸ªå†…å­˜å †ã€‚</p></blockquote><h2 id="å¤§å¯¹è±¡ç›´æ¥è¿›å…¥è€å¹´ä»£" tabindex="-1"><a class="header-anchor" href="#å¤§å¯¹è±¡ç›´æ¥è¿›å…¥è€å¹´ä»£"><span>å¤§å¯¹è±¡ç›´æ¥è¿›å…¥è€å¹´ä»£</span></a></h2><p>å¤§å¯¹è±¡æ˜¯æŒ‡éœ€è¦å¤§é‡è¿ç»­å†…å­˜ç©ºé—´çš„ Java å¯¹è±¡ï¼Œå¦‚å¾ˆé•¿çš„å­—ç¬¦ä¸²æˆ–æ•°æ®ã€‚</p><p>ä¸€ä¸ªå¤§å¯¹è±¡èƒ½å¤Ÿå­˜å…¥ Eden åŒºçš„æ¦‚ç‡æ¯”è¾ƒå°ï¼Œå‘ç”Ÿåˆ†é…æ‹…ä¿çš„æ¦‚ç‡æ¯”è¾ƒå¤§ï¼Œè€Œåˆ†é…æ‹…ä¿éœ€è¦æ¶‰åŠå¤§é‡çš„å¤åˆ¶ï¼Œå°±ä¼šé€ æˆæ•ˆç‡ä½ä¸‹ã€‚</p><p>è™šæ‹Ÿæœºæä¾›äº†ä¸€ä¸ª -XX:PretenureSizeThreshold å‚æ•°ï¼Œä»¤å¤§äºè¿™ä¸ªè®¾ç½®å€¼çš„å¯¹è±¡ç›´æ¥åœ¨è€å¹´ä»£åˆ†é…ï¼Œè¿™æ ·åšçš„ç›®çš„æ˜¯é¿å…åœ¨ Eden åŒºåŠä¸¤ä¸ª Survivor åŒºä¹‹é—´å‘ç”Ÿå¤§é‡çš„å†…å­˜å¤åˆ¶ã€‚ï¼ˆè¿˜è®°å¾—å—ï¼Œæ–°ç”Ÿä»£é‡‡ç”¨å¤åˆ¶ç®—æ³•å›æ”¶åƒåœ¾ï¼‰</p><h2 id="é•¿æœŸå­˜æ´»çš„å¯¹è±¡å°†è¿›å…¥è€å¹´ä»£" tabindex="-1"><a class="header-anchor" href="#é•¿æœŸå­˜æ´»çš„å¯¹è±¡å°†è¿›å…¥è€å¹´ä»£"><span>é•¿æœŸå­˜æ´»çš„å¯¹è±¡å°†è¿›å…¥è€å¹´ä»£</span></a></h2><p>JVM ç»™æ¯ä¸ªå¯¹è±¡å®šä¹‰äº†ä¸€ä¸ªå¯¹è±¡å¹´é¾„è®¡æ•°å™¨ã€‚å½“æ–°ç”Ÿä»£å‘ç”Ÿä¸€æ¬¡ Minor GC åï¼Œå­˜æ´»ä¸‹æ¥çš„å¯¹è±¡å¹´é¾„ +1ï¼Œå½“å¹´é¾„è¶…è¿‡ä¸€å®šå€¼æ—¶ï¼Œå°±å°†è¶…è¿‡è¯¥å€¼çš„æ‰€æœ‰å¯¹è±¡è½¬ç§»åˆ°è€å¹´ä»£ä¸­å»ã€‚</p><p>ä½¿ç”¨ <code>-XXMaxTenuringThreshold</code> è®¾ç½®æ–°ç”Ÿä»£çš„æœ€å¤§å¹´é¾„ï¼Œåªè¦è¶…è¿‡è¯¥å‚æ•°çš„æ–°ç”Ÿä»£å¯¹è±¡éƒ½ä¼šè¢«è½¬ç§»åˆ°è€å¹´ä»£ä¸­å»ã€‚</p><h2 id="åŠ¨æ€å¯¹è±¡å¹´é¾„åˆ¤å®š" tabindex="-1"><a class="header-anchor" href="#åŠ¨æ€å¯¹è±¡å¹´é¾„åˆ¤å®š"><span>åŠ¨æ€å¯¹è±¡å¹´é¾„åˆ¤å®š</span></a></h2><p>å¦‚æœå½“å‰æ–°ç”Ÿä»£çš„ Survivor ä¸­ï¼Œç›¸åŒå¹´é¾„æ‰€æœ‰å¯¹è±¡å¤§å°çš„æ€»å’Œå¤§äº Survivor ç©ºé—´çš„ä¸€åŠï¼Œå¹´é¾„ &gt;= è¯¥å¹´é¾„çš„å¯¹è±¡å°±å¯ä»¥ç›´æ¥è¿›å…¥è€å¹´ä»£ï¼Œæ— é¡»ç­‰åˆ° <code>MaxTenuringThreshold</code> ä¸­è¦æ±‚çš„å¹´é¾„ã€‚</p><h2 id="ç©ºé—´åˆ†é…æ‹…ä¿" tabindex="-1"><a class="header-anchor" href="#ç©ºé—´åˆ†é…æ‹…ä¿"><span>ç©ºé—´åˆ†é…æ‹…ä¿</span></a></h2><p>JDK 6 Update 24 ä¹‹å‰çš„è§„åˆ™æ˜¯è¿™æ ·çš„ï¼š</p><p>åœ¨å‘ç”Ÿ Minor GC ä¹‹å‰ï¼Œè™šæ‹Ÿæœºä¼šå…ˆæ£€æŸ¥<strong>è€å¹´ä»£æœ€å¤§å¯ç”¨çš„è¿ç»­ç©ºé—´æ˜¯å¦å¤§äºæ–°ç”Ÿä»£æ‰€æœ‰å¯¹è±¡æ€»ç©ºé—´</strong>ï¼Œ å¦‚æœè¿™ä¸ªæ¡ä»¶æˆç«‹ï¼ŒMinor GC å¯ä»¥ç¡®ä¿æ˜¯å®‰å…¨çš„ï¼› å¦‚æœä¸æˆç«‹ï¼Œåˆ™è™šæ‹Ÿæœºä¼šæŸ¥çœ‹ <code>HandlePromotionFailure</code> å€¼æ˜¯å¦è®¾ç½®ä¸ºå…è®¸æ‹…ä¿å¤±è´¥ï¼Œ å¦‚æœæ˜¯ï¼Œé‚£ä¹ˆä¼šç»§ç»­æ£€æŸ¥è€å¹´ä»£æœ€å¤§å¯ç”¨çš„è¿ç»­ç©ºé—´æ˜¯å¦å¤§äºå†æ¬¡æ™‹å‡åˆ°è€å¹´ä»£å¯¹è±¡çš„å¹³å‡å¤§å°ï¼Œ å¦‚æœå¤§äºï¼Œå°†å°è¯•è¿›è¡Œä¸€æ¬¡ Minor GCï¼Œå°½ç®¡è¿™æ¬¡ Minor GC æ˜¯æœ‰é£é™©çš„ï¼› å¦‚æœå°äºï¼Œæˆ–è€… <code>HandlePromotionFailure</code> è®¾ç½®ä¸å…è®¸å†’é™©ï¼Œé‚£æ­¤æ—¶ä¹Ÿè¦æ”¹ä¸ºè¿›è¡Œä¸€æ¬¡ Full GCã€‚</p><p>JDK 6 Update 24 ä¹‹åçš„è§„åˆ™å˜ä¸ºï¼š</p><p>åªè¦è€å¹´ä»£çš„è¿ç»­ç©ºé—´å¤§äºæ–°ç”Ÿä»£å¯¹è±¡æ€»å¤§å°æˆ–è€…å†æ¬¡æ™‹å‡çš„å¹³å‡å¤§å°ï¼Œå°±ä¼šè¿›è¡Œ Minor GCï¼Œå¦åˆ™å°†è¿›è¡Œ Full GCã€‚</p><p>é€šè¿‡æ¸…é™¤è€å¹´ä»£ä¸­çš„åºŸå¼ƒæ•°æ®æ¥æ‰©å¤§è€å¹´ä»£ç©ºé—²ç©ºé—´ï¼Œä»¥ä¾¿ç»™æ–°ç”Ÿä»£ä½œæ‹…ä¿ã€‚</p><p>è¿™ä¸ªè¿‡ç¨‹å°±æ˜¯åˆ†é…æ‹…ä¿ã€‚</p><hr><p>ğŸ‘‡ æ€»ç»“ä¸€ä¸‹æœ‰å“ªäº›æƒ…å†µå¯èƒ½ä¼šè§¦å‘ JVM è¿›è¡Œ Full GCã€‚</p><ol><li><strong><code>System.gc()</code> æ–¹æ³•çš„è°ƒç”¨</strong> æ­¤æ–¹æ³•çš„è°ƒç”¨æ˜¯å»ºè®® JVM è¿›è¡Œ Full GCï¼Œæ³¨æ„è¿™<strong>åªæ˜¯å»ºè®®è€Œéä¸€å®š</strong>ï¼Œä½†åœ¨å¾ˆå¤šæƒ…å†µä¸‹å®ƒä¼šè§¦å‘ Full GCï¼Œä»è€Œå¢åŠ  Full GC çš„é¢‘ç‡ã€‚é€šå¸¸æƒ…å†µä¸‹æˆ‘ä»¬åªéœ€è¦è®©è™šæ‹Ÿæœºè‡ªå·±å»ç®¡ç†å†…å­˜å³å¯ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ -XX:+ DisableExplicitGC æ¥ç¦æ­¢è°ƒç”¨ <code>System.gc()</code>ã€‚</li><li><strong>è€å¹´ä»£ç©ºé—´ä¸è¶³</strong> è€å¹´ä»£ç©ºé—´ä¸è¶³ä¼šè§¦å‘ Full GC æ“ä½œï¼Œè‹¥è¿›è¡Œè¯¥æ“ä½œåç©ºé—´ä¾ç„¶ä¸è¶³ï¼Œåˆ™ä¼šæŠ›å‡ºå¦‚ä¸‹é”™è¯¯ï¼š<code>java.lang.OutOfMemoryError: Java heap space</code></li><li><strong>æ°¸ä¹…ä»£ç©ºé—´ä¸è¶³</strong> JVM è§„èŒƒä¸­è¿è¡Œæ—¶æ•°æ®åŒºåŸŸä¸­çš„æ–¹æ³•åŒºï¼Œåœ¨ HotSpot è™šæ‹Ÿæœºä¸­ä¹Ÿç§°ä¸ºæ°¸ä¹…ä»£ï¼ˆPermanet Generationï¼‰ï¼Œå­˜æ”¾ä¸€äº›ç±»ä¿¡æ¯ã€å¸¸é‡ã€é™æ€å˜é‡ç­‰æ•°æ®ï¼Œå½“ç³»ç»Ÿè¦åŠ è½½çš„ç±»ã€åå°„çš„ç±»å’Œè°ƒç”¨çš„æ–¹æ³•è¾ƒå¤šæ—¶ï¼Œæ°¸ä¹…ä»£å¯èƒ½ä¼šè¢«å æ»¡ï¼Œä¼šè§¦å‘ Full GCã€‚å¦‚æœç»è¿‡ Full GC ä»ç„¶å›æ”¶ä¸äº†ï¼Œé‚£ä¹ˆ JVM ä¼šæŠ›å‡ºå¦‚ä¸‹é”™è¯¯ä¿¡æ¯ï¼š<code>java.lang.OutOfMemoryError: PermGen space </code></li><li><strong>CMS GC æ—¶å‡ºç° <code>promotion failed</code> å’Œ <code>concurrent mode failure</code></strong> promotion failedï¼Œå°±æ˜¯ä¸Šæ–‡æ‰€è¯´çš„æ‹…ä¿å¤±è´¥ï¼Œè€Œ concurrent mode failure æ˜¯åœ¨æ‰§è¡Œ CMS GC çš„è¿‡ç¨‹ä¸­åŒæ—¶æœ‰å¯¹è±¡è¦æ”¾å…¥è€å¹´ä»£ï¼Œè€Œæ­¤æ—¶è€å¹´ä»£ç©ºé—´ä¸è¶³é€ æˆçš„ã€‚</li><li><strong>ç»Ÿè®¡å¾—åˆ°çš„ Minor GC æ™‹å‡åˆ°æ—§ç”Ÿä»£çš„å¹³å‡å¤§å°å¤§äºè€å¹´ä»£çš„å‰©ä½™ç©ºé—´ã€‚</strong></li></ol>',27)]))}const r=a(t,[["render",s]]),m=JSON.parse('{"path":"/05-memory-allocation-gc.html","title":"å†…å­˜åˆ†é…ä¸å›æ”¶ç­–ç•¥","lang":"zh-CN","frontmatter":{},"headers":[{"level":2,"title":"å¯¹è±¡ä¼˜å…ˆåœ¨ Eden åˆ†é…","slug":"å¯¹è±¡ä¼˜å…ˆåœ¨-eden-åˆ†é…","link":"#å¯¹è±¡ä¼˜å…ˆåœ¨-eden-åˆ†é…","children":[]},{"level":2,"title":"å¤§å¯¹è±¡ç›´æ¥è¿›å…¥è€å¹´ä»£","slug":"å¤§å¯¹è±¡ç›´æ¥è¿›å…¥è€å¹´ä»£","link":"#å¤§å¯¹è±¡ç›´æ¥è¿›å…¥è€å¹´ä»£","children":[]},{"level":2,"title":"é•¿æœŸå­˜æ´»çš„å¯¹è±¡å°†è¿›å…¥è€å¹´ä»£","slug":"é•¿æœŸå­˜æ´»çš„å¯¹è±¡å°†è¿›å…¥è€å¹´ä»£","link":"#é•¿æœŸå­˜æ´»çš„å¯¹è±¡å°†è¿›å…¥è€å¹´ä»£","children":[]},{"level":2,"title":"åŠ¨æ€å¯¹è±¡å¹´é¾„åˆ¤å®š","slug":"åŠ¨æ€å¯¹è±¡å¹´é¾„åˆ¤å®š","link":"#åŠ¨æ€å¯¹è±¡å¹´é¾„åˆ¤å®š","children":[]},{"level":2,"title":"ç©ºé—´åˆ†é…æ‹…ä¿","slug":"ç©ºé—´åˆ†é…æ‹…ä¿","link":"#ç©ºé—´åˆ†é…æ‹…ä¿","children":[]}],"git":{"updatedTime":1652175101000,"contributors":[{"name":"æ¨ç«‹æ»¨","username":"æ¨ç«‹æ»¨","email":"szuyanglb@outlook.com","commits":3,"url":"https://github.com/æ¨ç«‹æ»¨"},{"name":"yanglbme","username":"yanglbme","email":"szuyanglb@outlook.com","commits":12,"url":"https://github.com/yanglbme"},{"name":"æ¨ç«‹æ»¨","username":"æ¨ç«‹æ»¨","email":"contact@yanglibin.info","commits":1,"url":"https://github.com/æ¨ç«‹æ»¨"},{"name":"chenqiao","username":"chenqiao","email":"bigjoechan@163.com","commits":1,"url":"https://github.com/chenqiao"}],"changelog":[{"hash":"f7ac74e7ad02443ae6d654dfaca8225137f30133","time":1652175101000,"email":"bigjoechan@163.com","author":"chenqiao","message":"docs: update 05-memory-allocation-gc.md (#27)"},{"hash":"046ea2d9712bb7361e2dd7c09569cf631c16253f","time":1630462961000,"email":"szuyanglb@outlook.com","author":"yanglbme","message":"docs: update parts 03,04,05,09"},{"hash":"84b1e1a6cd735a27a2753cf84cec68ffc14b65e4","time":1627991187000,"email":"szuyanglb@outlook.com","author":"yanglbme","message":"docs: update articles"},{"hash":"b9ac90393daa17ac91f072406788d0320cd7ef97","time":1603199026000,"email":"yanglbme@users.noreply.github.com","author":"yanglbme","message":"docs: prettify code"},{"hash":"44141143eaf33a804d08844e6437b0dc4995261e","time":1586069633000,"email":"szuyanglb@outlook.com","author":"yanglbme","message":"feat: add docsify and pagination"},{"hash":"5812abcddf7be190ae25ff2f4fae537c1d75953c","time":1531985256000,"email":"szuyanglb@outlook.com","author":"yanglbme","message":"Update index"},{"hash":"fc29eb9f65b88bdd5dd5dcb0cc2ef782e463ff3b","time":1531984929000,"email":"szuyanglb@outlook.com","author":"yanglbme","message":"Add Index"},{"hash":"7a92c0e4989eb8136143d52d2281fb15257b44be","time":1531278268000,"email":"szuyanglb@outlook.com","author":"yanglbme","message":"Write EOF"},{"hash":"319771e9b756415503f65216741aec07144bf574","time":1531037312000,"email":"szuyanglb@outlook.com","author":"æ¨ç«‹æ»¨","message":"Update 05-memory-allocation-gc.md"},{"hash":"26f448edcf8b90cc1fdef5065118d1ef6b7b6a07","time":1531021558000,"email":"szuyanglb@outlook.com","author":"æ¨ç«‹æ»¨","message":"Update 05-memory-allocation-gc.md"},{"hash":"44bb9a33ee01e13ffc8817d77cfee3fefb474161","time":1530252948000,"email":"szuyanglb@outlook.com","author":"yanglbme","message":"Change path"},{"hash":"99ce82b1d8aa7c6e6451e108e35dfd958c05420c","time":1530186676000,"email":"szuyanglb@outlook.com","author":"yanglbme","message":"Remove TOC"},{"hash":"a112cfd4f8cbd9de87c68112101c0ce4ed4a3fe5","time":1530183324000,"email":"contact@yanglibin.info","author":"æ¨ç«‹æ»¨","message":"GitBook: [master] 12 pages modified"},{"hash":"26a1c453f8e4f2b56f07c9d36aae1959a1cf2e5f","time":1529933044000,"email":"szuyanglb@outlook.com","author":"yanglbme","message":"Format doc style"},{"hash":"3d396e0a4b59619bbcbf24b383cbb1b0a858e136","time":1529914171000,"email":"szuyanglb@outlook.com","author":"yanglbme","message":"Update format"},{"hash":"e7436bd325af1fb64abbeb4886609414a17f3327","time":1529912260000,"email":"szuyanglb@outlook.com","author":"yanglbme","message":"Rename filename"},{"hash":"341f1a14bc1454af3de1395119d89d62aaba8e22","time":1529839056000,"email":"szuyanglb@outlook.com","author":"æ¨ç«‹æ»¨","message":"Create 05_å†…å­˜åˆ†é…ä¸å›æ”¶ç­–ç•¥.md"}]},"filePathRelative":"05-memory-allocation-gc.md"}');export{r as comp,m as data};
